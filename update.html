<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Update_page</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<h1>Employee Payroll System</h1><br><br><br>
<h2>Update Record</h2>
<form id="updateForm" action="update_process.jsp" method="post">
    <div class="form-group">
        <h3>Employee ID</h3>
        <input type="text" id="empid" name="empid" value="">
        <span class="error" id="empidError"></span>
    </div>
    
    <div class="form-group">
        <h3>Select Field for updation</h3>
        <select id="field" name="field">
            <option value="">-- Select Field --</option>
            <option value="empname">Employee Name</option>
            <option value="empcity">Employee City</option>
            <option value="empdep">Employee Department</option>
            <option value="empsal">Employee Salary</option>
        </select>
        <span class="error" id="fieldError"></span>
    </div>
    
    <div class="form-group" id="updateValue">
        <h3>Enter Update Value</h3>
        <input type="text" id="upd" name="upd" value="">
        <span class="error" id="updError"></span>
    </div>
    
    <input id="b2" type="submit" name="submit" value="Submit"></input><br><br><br><br>
    <a href="index.html">Home Page</a>
</form>

<script>
$(document).ready(function() {
    // Show/hide update value field based on selection
    $('#field').change(function() {
        var selectedField = $(this).val();
        if (selectedField !== '') {
            $('#updateValue').slideDown(300);
            $('#upd').val(''); // Clear previous value
            $('#updError').text('');
            
            // Update placeholder based on selection
            var placeholder = '';
            switch(selectedField) {
                case 'empname':
                    placeholder = 'Enter new employee name';
                    break;
                case 'empcity':
                    placeholder = 'Enter new city';
                    break;
                case 'empdep':
                    placeholder = 'Enter new department';
                    break;
                case 'empsal':
                    placeholder = 'Enter new salary';
                    break;
            }
            $('#upd').attr('placeholder', placeholder);
        } else {
            $('#updateValue').slideUp(300);
        }
    });
    
    // Form validation
    $('#updateForm').submit(function(e) {
        var isValid = true;
        $('.error').text('');
        
        // Validate Employee ID
        var empid = $('#empid').val().trim();
        if (empid === '') {
            $('#empidError').text('Employee ID is required');
            isValid = false;
        } else if (!/^\d+$/.test(empid)) {
            $('#empidError').text('Employee ID must be numeric');
            isValid = false;
        }
        
        // Validate Field Selection
        var field = $('#field').val();
        if (field === '') {
            $('#fieldError').text('Please select a field to update');
            isValid = false;
        }
        
        // Validate Update Value
        var upd = $('#upd').val().trim();
        if (upd === '') {
            $('#updError').text('Update value is required');
            isValid = false;
        } else {
            // Field-specific validation
            if (field === 'empsal' && !/^\d+(\.\d{1,2})?$/.test(upd)) {
                $('#updError').text('Salary must be a valid number');
                isValid = false;
            } else if (field === 'empname' && !/^[a-zA-Z\s]+$/.test(upd)) {
                $('#updError').text('Name must contain only letters');
                isValid = false;
            }
        }
        
        if (!isValid) {
            e.preventDefault();
            return false;
        }
        
        // Confirmation dialog
        var confirmMsg = 'Are you sure you want to update Employee ID ' + empid + '?';
        return confirm(confirmMsg);
    });
    
    // Fade in animation
    $('form').hide().fadeIn(800);
});
</script>
</body>
</html>